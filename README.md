# Human vs. AI text Classification

## Постановка задачи

Цель проекта — разработать систему, которая классифицирует текст как написанный
человеком или сгенерированный искусственным интеллектом.

## Формат входных и выходных данных

Входные данные: текст произвольной длины

Выходные данные: 0 или 1 (бинарная классификация)

## Валидация и тест

Я поделил данные на трейн, валидацию и тест (их вполне достаточно для такой
стратегии). Данные загружены на гугл диск

## Датасеты

Будет использоваться датасет соревнования Human vs. AI Text Classification (Feb
2024).

https://www.kaggle.com/competitions/human-vs-ai-text-classification-feb2024

Датасет содержит тексты, написанные людьми, и тексты, сгенерированные различными
моделями ИИ.

Порядка 500К текстов (900 МБ)

Классы: human, ai

Тексты различной длины и стиля. Все на английском языке

Присутствуют как короткие ответы, так и большие эссе.

## Моделирование

После рассмотрения работы победителей было принято решение дообучать модель на
основе encoder, был выбран DistillBert, проведены эксперименты с обучением
только головы и последних слоев. Также были проведены эксперименты с более
простым подходом (на основе TF-IDF представлений), при незначительной потере
качества в сравнении с моими экспериментами и доступными работами победителей,
они показывали значительное ускорение работы, в связи с этим было принято
решение остановиться на них.

## Setup

Зависимости в проекте управляются poetry

Клонируйте проект и создайте виртуальное окружение используя poetry, активируйте
хуки

```
# Установка зависимостей
poetry install

# Установка хуков
poetry run pre-commit install

# Запуск проверок
poetry run pre-commit run --all-files
```

## Train

Вы можете использовать команду

```
python commands.py download_data
```

(После этого вы можете добавить эти данные в двс и загружать уже из кэша)

для автоматической загрузки и проверки версии данных (dvc), она также будет
применена при запуске функции train

Для запуска тренировки используйте команду (предполагается, что сервер MLFlow
поднят)

```
# Если сервера нет, его можно запустить этой командой
mlflow server --host 127.0.0.1 --port 8080 --workers 1
```

```
python commands.py train
```

## Production preparation

Модель автоматически сохраняется в onnx формате после обучения.

## Infer

Вы можете проверить текст, используя сохраненную модель, используя следующую
команду.

(Учитывайте, что модель обучена на английском языке)

```
python commands.py predict "your text here"
```
